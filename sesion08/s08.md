# Excel con Dashboards

![logo](https://www.belatrix.com/wp-content/uploads/2023/08/belatrix-logosweb-1.png)

> Alan Badillo Salas (alan@belatrix.com)

```markdown
Módulo III – Automatización con Macros y VBA

1. Introducción a las macros y VBA
2. Acceso y modificación de celdas en VBA
3. Vectores y matrices
4. Funciones personalizadas (UDF)
5. Controles del programador
```

## 1. Condicionales

Se usan para ejecutar código según una condición.

> `If...Then...Else` — la más común

```vba
If x > 0 Then
    MsgBox "Positivo"
ElseIf x = 0 Then
    MsgBox "Cero"
Else
    MsgBox "Negativo"
End If
```

> `Select Case` — más limpio cuando hay muchas opciones

```vba
Select Case dia
    Case 1: MsgBox "Lunes"
    Case 2: MsgBox "Martes"
    Case Else: MsgBox "Otro día"
End Select
```

## 2. Bucles (iterador, secuenciador y ciclo)

Permiten repetir instrucciones varias veces.

> `For...Next` — número fijo de repeticiones (iterador)

```vba
For i = 1 To 10
    Debug.Print i
Next i
```

> `For Each...Next` — recorrer elementos de una colección o rango (secuenciador)

```vba
For Each celda In Range("A1:A5")
    Debug.Print celda.Value
Next celda
```

> `Do While...Loop` — se repite mientras la condición sea verdadera (ciclo mientras)

```vba
Do While x < 10
    x = x + 1
Loop
```

> `Do Until...Loop` — se repite hasta que la condición sea verdadera (ciclo hasta)

```vba
Do Until x = 10
    x = x + 1
Loop
```

> `Do...Loop While / Do...Loop Until` — evalúan la condición al final (ciclo inverso)

```vba
Do
    x = x + 1
Loop While x < 10
```

```vba
Do
    x = x + 1
Loop until x = 10
```

## 3. Saltos y control especial

Sirven para modificar el flujo de un bucle o procedimiento.

> `Exit For / Exit Do` — salir antes de terminar el bucle (interruptor)

```vba
For i = 1 To 10
    If i = 5 Then Exit For
Next i
```

**Nota:** Continue no existe en VBA, pero se simula usando `GoTo` o `If` para saltar al final de la iteración.

> Etiqueta `GoTo` — salta a una parte del código (se recomienda poco)

```vba
If errorDetectado Then GoTo Fin
' ...
Fin:
MsgBox "Terminado"
```

## Resumen

* Condicionales: `If...Then...Else`, `Select Case`
* Bucles: `For...Next`, `For Each...Next`, `Do While`, `Do Until`
* Saltos: `Exit`, `GoTo` (con moderación / cuando hay errores complicados)