# Excel con Dashboards

![logo](https://www.belatrix.com/wp-content/uploads/2023/08/belatrix-logosweb-1.png)

> Alan Badillo Salas (alan@belatrix.com)

```markdown
M√≥dulo I ‚Äì Fundamentos y modelado de datos con Excel

1.	F√≥rmulas de b√∫squeda y coincidencia
2.	F√≥rmulas de agregaci√≥n
3.	Manejo de otras funciones clave
4.	Tablas estructuradas y concentrados
5.	Buenas pr√°cticas en la preparaci√≥n de datos
```

## M103 - Manejo de otras funciones clave

### Vectores

Representan un rango lineal dispuesto en filas o columnas en un rango:

> Ejemplo: Vector columna (columna A)
>
> Filas: 6, 7, 8, 9, 10

```excel
=A6:A10
```


> Ejemplo: Vector fila (fila 6)
>
> Columnas: B, C, D, E, F

```excel
=B6:F6
```

### Matrices

Representan un rango general desde una columna inicial y una fila inicial, hasta una columna final y una fila final:

> Ejemplo: Matriz de datos
>
> Columnas B, C, D, E, F
> Filas: 6, 7, 8, 9, 10

```excel
=B6:F10
```

### M√°scaras de datos

Una m√°scara es el resultado de sumar las l√≥gicas das por un vector o matriz (rango en general) poniendo condiciones al rango:

> Ejemplo: M√°scara acumulativa
> 
> Determinar si la matriz `F5:I13` tiene valores entre 6 y menores a 9

```excel
=(F5:I13 >= 6) + (F5:I13 < 9) 
```

Cada condici√≥n ser√° sumada l√≥gicamente, formando una m√°scara, por ejemplo si tenemos la matriz:

```text
10	9	10	8
9	8	10	6
6	9	7	9
5	7	5	8
8	9	8	6
9	9	9	9
10	7	6	9
5	10	8	8
8	10	7	8
```

La suma de las dos condiciones (`(F5:I13 >= 6) + (F5:I13 < 9)`) formar√° la m√°scara:

```text
1	1	1	2
1	2	1	2
2	1	2	1
1	2	1	2
2	1	2	2
1	1	1	1
1	2	2	1
1	1	2	2
2	1	2	2
```

Donde `1` representar√° que se cumple una de las dos condiciones y `2` representar√° que se cumplen ambas condiciones.

Cuando deseamos aplicar un operador `OR` (conjunci√≥n l√≥gica), bastar√° determinar si la m√°scara es `>= 1`, pero si queremos aplicar un `AND` (disyunci√≥n l√≥gica), tendremos que determinar si la m√°scara es `= <n>` donde `<n>` es el n√∫mero de condiciones impuestas (en este caso `2`).

As√≠, podemos construir la m√°scara l√≥gica `OR` o `AND` mediante:

* `OR` - `=(F5:I13 >= 6) + (F5:I13 < 9) >= 1`
* `AND` - `=(F5:I13 >= 6) + (F5:I13 < 9) = 2`

Por ejemplo, para determinar si se cumplen ambas condiciones tendr√≠amos (`=(F5:I13 >= 6) + (F5:I13 < 9) = 2`):

```text
FALSO       FALSO       FALSO       VERDADERO
FALSO	    VERDADERO	FALSO	    VERDADERO
VERDADERO	FALSO	    VERDADERO	FALSO
FALSO	    VERDADERO	FALSO	    VERDADERO
VERDADERO	FALSO	    VERDADERO	VERDADERO
FALSO	    FALSO	    FALSO	    FALSO
FALSO	    VERDADERO	VERDADERO	FALSO
FALSO	    FALSO	    VERDADERO	VERDADERO
VERDADERO	FALSO	    VERDADERO	VERDADERO
```

### üîç FILTRAR (Filtro Din√°mico)

Devuelve din√°micamente los valores que cumplen una o m√°s condiciones desde un rango o matriz, permitiendo aplicar filtros complejos como m√∫ltiples `AND` u `OR`.

```text
=FILTRAR(<matriz>, <incluir>, [<si vac√≠o>])
```

* `<matriz>` - Matriz o tabla a filtrar
* `<incluir>` - Vector de √≠ndices que cumplen la condici√≥n
* `<si vac√≠o>` - Valor, vector o matriz opcional

> Ejemplo

Seleccionar las personas (columna A), que tienen entre 6 y menos de 9 de calificaci√≥n en matem√°ticas (columna B)

```excel
=FILTRAR(A6:A10, (B6:B10>=6)*(B6:B10<9))
```

## M104. Tablas estructuradas y concentrados

### Tablas estructuradas

Al seleccionar una regi√≥n de datos (datos y encabezados con `CTRL+E`), podemos transformar los valores a una tabla estructurada mediante (`CTRL+T`).

Al crear esta tabla estructurada en la pesta√±a **Dise√±o de la Tabla** podremos configurar opciones como el nombre de la tabla, las columnas remarcadas y si tendr√° totales.

Una vez configurada la tabla (por ejemplo `Tabla1`), desde cualquier celda en el libro, podremos llamar a la tabla mediante:

> Proyectar los datos de la tabla

```excel
=Tabla1
```

> Proyectar los encabezados de la tabla

```excel
=Tabla1[#Encabezados]
```

> Proyectar una columna de la tabla (por ejemplo, `Enero`)

```excel
=Tabla1[Enero]
```

> Proyectar varias columnas de la tabla (por ejemplo, `Enero` hasta `Abril`)

```excel
=Tabla1[Enero]:Tabla1[Abril]
```

(Opcionalmente)

```excel
=Tabla1[[#Datos],[Enero]:[Abril]]
```

> Proyectar una fila de la tabla (por ejemplo, la fila `3`)

```excel
=INDICE(Tabla1, 3, 0)
```

> Proyectar una columna din√°mica de la tabla (por ejemplo, dada por la celda `A1`)
>
> Para todas las filas

```excel
=INDICE(Tabla1, 0, COINCIDIR(A1, Tabla1[#Encabezados], 0))
```

> Proyectar una fila din√°mica de la tabla (por ejemplo, dada por la celda `A2`)
>
> Para todas las columnas

```excel
=INDICE(Tabla1, A2, 0)
```

> Proyectar una fila din√°mica de la tabla (por ejemplo, dada por la celda `A2`)
>
> Para todas las columnas

```excel
=INDICE(Tabla1, A2, 0)
```

> Proyectar una fila din√°mica de la tabla (por ejemplo, dada por la celda `A2`)
>
> Para todas las columnas de `Enero` a `Marzo`

```excel
=INDICE(Tabla1[Enero],Tabla1[Marzo], A2, 0)
```

## M105. Buenas pr√°cticas en la preparaci√≥n de datos

La calidad de los an√°lisis depende directamente de c√≥mo se preparan los datos. Revisemos algunas claves para estructurar datos correctamente antes de analizarlos o construir dashboards.

### 1. Estructura tabular

Organiza los datos en forma de tabla, donde:

* Cada fila representa un registro √∫nico (observaci√≥n).
* Cada columna representa una variable √∫nica (atributo o campo).

Evita estructuras con datos fusionados, encabezados m√∫ltiples o secciones separadas.

### 2. Encabezados claros y √∫nicos

* Usa nombres descriptivos y sin espacios o caracteres especiales.
* Aseg√∫rate de que todos los encabezados sean √∫nicos.
* Evita celdas vac√≠as en la fila de encabezados.

> Ejemplo

```text
Nombre     Edad     Ciudad     FechaIngreso
```

### 3. Tipos de datos consistentes

* Aseg√∫rate de que los valores en cada columna sean del mismo tipo: texto, n√∫mero, fecha, etc.
* No mezcles formatos (ej. fechas y texto en la misma columna).
* Evita entradas como ‚ÄúN/A‚Äù, ‚Äú‚Äî‚Äù o ‚Äú-‚Äù si no son v√°lidas como valores.

### 4. No usar celdas fusionadas

Las celdas fusionadas dificultan el uso de f√≥rmulas, filtros y tablas din√°micas. Siempre trabaja con celdas simples.

### 5. Evita valores calculados ocultos

No incluyas totales, subtotales o promedios integrados dentro de los datos. Es mejor usar f√≥rmulas aparte o c√°lculos din√°micos.

> Ejemplo incorrecto

```text
Producto     Mes     Ventas
Pan          Ene      120
Pan          Feb      100
Pan          Mar      150
TOTAL                 370   ‚Üê ‚ùå No debe ir en la tabla
```

### 6. Usa validaci√≥n de datos

* Para columnas con valores limitados (ej. ‚ÄúSexo‚Äù: Hombre, Mujer), usa listas desplegables.
* Esto reduce errores y facilita el an√°lisis posterior.

### 7. Evita celdas vac√≠as en registros importantes

* Si hay celdas vac√≠as en campos cr√≠ticos como ID, Nombre, Fecha o Monto, el an√°lisis puede fallar.
* Considera usar valores nulos expl√≠citos (0, "N/A", "Sin dato") seg√∫n el caso.

### 8. Ordena los datos regularmente

Mantener los datos ordenados por fecha, nombre o clave ayuda a detectar errores y patrones.

### 9. Expectativas

Estas pr√°cticas son clave para garantizar:

* El uso correcto de f√≥rmulas como BUSCARV, FILTRAR, XLOOKUP, INDICE y COINCIDIR.
* La integraci√≥n fluida con tablas din√°micas y dashboards.
* La facilidad para importar/exportar datos entre Excel y otras herramientas (como Power BI, SQL, R o Python).

üìå Una buena preparaci√≥n de datos evita m√°s del 80% de los errores comunes en el an√°lisis.